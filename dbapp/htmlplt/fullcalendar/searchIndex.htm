<HTML><HEAD><TITLE>搜索</TITLE>
<META content=IE=8 http-equiv=X-UA-Compatible>
<META content="text/html; charset=UTF-8" http-equiv=content-type>
<LINK rel=stylesheet type=text/css href="/msa/extjs/resources/css/ext-all.css">
<link rel="stylesheet" type="text/css" href="/msa/extjs/resources/css/feed-viewer.css" />
<LINK rel=stylesheet type=text/css href="/msa/extjs/resources/css/xtheme-default.css" id="xthemecss" >
<script type="text/javascript" src="/msa/extjs/adapter/ext/ext-base.js"></script>
<SCRIPT type=text/javascript  src="/msa/extjs/ext-all.js"></SCRIPT>
<STYLE id=gstyle>
BODY {
	OVERFLOW-Y: scroll; MARGIN: 0px
	FONT-FAMILY: arial, sans-serif
}
TD {
	LINE-HEIGHT: 0.8em
}
.gac_m TD {
	LINE-HEIGHT: 17px
}
FORM {
	MARGIN-TOP: 18px; MARGIN-BOTTOM: 20px
}
BODY {
	FONT-FAMILY: arial, sans-serif
}
TD {
	FONT-FAMILY: arial, sans-serif
}
A {
	FONT-FAMILY: arial, sans-serif
}
P {
	FONT-FAMILY: arial, sans-serif
}
.h {
	FONT-FAMILY: arial, sans-serif
}
.h {
	COLOR: #12c; FONT-SIZE: 20px
}
.q {
	COLOR: #00c
}
.ts TD {
	PADDING-BOTTOM: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: 0px; PADDING-TOP: 0px
}
.ts {
	BORDER-COLLAPSE: collapse
}
EM {
	FONT-STYLE: normal; COLOR: #c03; FONT-WEIGHT: normal
}
A EM {
	TEXT-DECORATION: underline
}
.lst {
	WIDTH: 496px; FLOAT: right; HEIGHT: 25px
}
#lst-ib:hover {
	BORDER-BOTTOM-COLOR: #b9b9b9 !important; BORDER-TOP-COLOR: #a0a0a0 !important; BORDER-RIGHT-COLOR: #b9b9b9 !important; BORDER-LEFT-COLOR: #b9b9b9 !important
}
.lst-d-f#lst-ib {
	BORDER-BOTTOM-COLOR: #4d90fe !important; BORDER-TOP-COLOR: #4d90fe !important; BORDER-RIGHT-COLOR: #4d90fe !important; BORDER-LEFT-COLOR: #4d90fe !important
}
.lst-d-f#lst-ib:hover {
	BORDER-BOTTOM-COLOR: #4d90fe !important; BORDER-TOP-COLOR: #4d90fe !important; BORDER-RIGHT-COLOR: #4d90fe !important; BORDER-LEFT-COLOR: #4d90fe !important
}
.lst {
	FONT: 18px arial, sans-serif
}
DIV.ds {
	WIDTH: 512px
}
.ds {
	MARGIN: 3px 0px 4px 4px; DISPLAY: inline-block
}
.ctr-p {
	MIN-WIDTH: 817px; MARGIN: 0px auto
}
.jhp INPUT[type='button'] {
	BORDER-BOTTOM: #dcdcdc 1px solid; MIN-WIDTH: 54px; TEXT-ALIGN: center; FILTER: progid:DXImageTransform.Microsoft.gradient(startColorStr='#f5f5f5',EndColorStr='#f1f1f1'); BORDER-LEFT: #dcdcdc 1px solid; PADDING-BOTTOM: 0px; LINE-HEIGHT: 27px; BACKGROUND-COLOR: #f5f5f5; MARGIN: 11px 6px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; HEIGHT: 29px; COLOR: #666; FONT-SIZE: 11px; BORDER-TOP: #dcdcdc 1px solid; CURSOR: pointer; FONT-WEIGHT: bold; BORDER-RIGHT: #dcdcdc 1px solid; PADDING-TOP: 0px; border-radius: 2px
}
.gssb_c INPUT {
	BORDER-BOTTOM: #dcdcdc 1px solid; MIN-WIDTH: 54px; TEXT-ALIGN: center; FILTER: progid:DXImageTransform.Microsoft.gradient(startColorStr='#f5f5f5',EndColorStr='#f1f1f1'); BORDER-LEFT: #dcdcdc 1px solid; PADDING-BOTTOM: 0px; LINE-HEIGHT: 27px; BACKGROUND-COLOR: #f5f5f5; MARGIN: 11px 6px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; HEIGHT: 29px; COLOR: #666; FONT-SIZE: 11px; BORDER-TOP: #dcdcdc 1px solid; CURSOR: pointer; FONT-WEIGHT: bold; BORDER-RIGHT: #dcdcdc 1px solid; PADDING-TOP: 0px; border-radius: 2px
}
.gac_bt INPUT {
	BORDER-BOTTOM: #dcdcdc 1px solid; MIN-WIDTH: 54px; TEXT-ALIGN: center; FILTER: progid:DXImageTransform.Microsoft.gradient(startColorStr='#f5f5f5',EndColorStr='#f1f1f1'); BORDER-LEFT: #dcdcdc 1px solid; PADDING-BOTTOM: 0px; LINE-HEIGHT: 27px; BACKGROUND-COLOR: #f5f5f5; MARGIN: 11px 6px; PADDING-LEFT: 8px; PADDING-RIGHT: 8px; HEIGHT: 29px; COLOR: #666; FONT-SIZE: 11px; BORDER-TOP: #dcdcdc 1px solid; CURSOR: pointer; FONT-WEIGHT: bold; BORDER-RIGHT: #dcdcdc 1px solid; PADDING-TOP: 0px; border-radius: 2px
}
.jhp INPUT[type='button']:hover {
	BORDER-BOTTOM: #c6c6c6 1px solid; FILTER: progid:DXImageTransform.Microsoft.gradient(startColorStr='#f8f8f8',EndColorStr='#f1f1f1'); BORDER-LEFT: #c6c6c6 1px solid; BACKGROUND-COLOR: #f8f8f8; COLOR: #333; BORDER-TOP: #c6c6c6 1px solid; BORDER-RIGHT: #c6c6c6 1px solid; box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1)
}
.gssb_c INPUT:hover {
	BORDER-BOTTOM: #c6c6c6 1px solid; FILTER: progid:DXImageTransform.Microsoft.gradient(startColorStr='#f8f8f8',EndColorStr='#f1f1f1'); BORDER-LEFT: #c6c6c6 1px solid; BACKGROUND-COLOR: #f8f8f8; COLOR: #333; BORDER-TOP: #c6c6c6 1px solid; BORDER-RIGHT: #c6c6c6 1px solid; box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1)
}
.gac_bt INPUT:hover {
	BORDER-BOTTOM: #c6c6c6 1px solid; FILTER: progid:DXImageTransform.Microsoft.gradient(startColorStr='#f8f8f8',EndColorStr='#f1f1f1'); BORDER-LEFT: #c6c6c6 1px solid; BACKGROUND-COLOR: #f8f8f8; COLOR: #333; BORDER-TOP: #c6c6c6 1px solid; BORDER-RIGHT: #c6c6c6 1px solid; box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1)
}
.jhp INPUT[type='button']:focus {
	BORDER-BOTTOM: #4d90fe 1px solid; BORDER-LEFT: #4d90fe 1px solid; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; OUTLINE-WIDTH: medium; BORDER-TOP: #4d90fe 1px solid; BORDER-RIGHT: #4d90fe 1px solid
}
.gssb_c INPUT:focus {
	BORDER-BOTTOM: #4d90fe 1px solid; BORDER-LEFT: #4d90fe 1px solid; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; OUTLINE-WIDTH: medium; BORDER-TOP: #4d90fe 1px solid; BORDER-RIGHT: #4d90fe 1px solid
}
.gac_bt INPUT:focus {
	BORDER-BOTTOM: #4d90fe 1px solid; BORDER-LEFT: #4d90fe 1px solid; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; OUTLINE-WIDTH: medium; BORDER-TOP: #4d90fe 1px solid; BORDER-RIGHT: #4d90fe 1px solid
}
.gssb_c INPUT {
	MARGIN: 6px
}
.gac_bt INPUT {
	MARGIN: 6px
}
INPUT {
	FONT-FAMILY: inherit
}
A.gb1 {
	COLOR: #11c !important
}
A.gb2 {
	COLOR: #11c !important
}
A.gb3 {
	COLOR: #11c !important
}
A.gb4 {
	COLOR: #11c !important
}
#gbar {
	FONT-SIZE: 13px; PADDING-TOP: 1px !important
}
#guser {
	FONT-SIZE: 13px; PADDING-TOP: 1px !important
}
#gbar {
	FLOAT: left; HEIGHT: 22px
}
#guser {
	TEXT-ALIGN: right; PADDING-BOTTOM: 7px !important
}
.gbh {
	FONT-SIZE: 1px; BORDER-TOP: #c9d7f1 1px solid
}
.gbd {
	FONT-SIZE: 1px; BORDER-TOP: #c9d7f1 1px solid
}
.gbh {
	POSITION: absolute; WIDTH: 100%; HEIGHT: 0px; TOP: 24px
}
#gbs {
	Z-INDEX: 1000; POSITION: absolute; TEXT-ALIGN: left; BACKGROUND: #fff; VISIBILITY: hidden; LEFT: 0px
}
.gbm {
	Z-INDEX: 1000; POSITION: absolute; TEXT-ALIGN: left; BACKGROUND: #fff; VISIBILITY: hidden; LEFT: 0px
}
.gbm {
	Z-INDEX: 1001; BORDER-BOTTOM: #36c 1px solid; BORDER-LEFT: #a2bae7 1px solid; BORDER-TOP: #c9d7f1 1px solid; BORDER-RIGHT: #36c 1px solid
}
.gb1 {
	MARGIN-RIGHT: 0.5em
}
.gb1 {
	ZOOM: 1
}
.gb3 {
	ZOOM: 1
}
.gb2 {
	PADDING-BOTTOM: 0.2em; PADDING-LEFT: 0.5em; PADDING-RIGHT: 0.5em; DISPLAY: block; PADDING-TOP: 0.2em
}
.gb2 {
	BORDER-BOTTOM: medium none; TEXT-DECORATION: none !important
}
.gb3 {
	BORDER-BOTTOM: medium none; TEXT-DECORATION: none !important
}
A.gb1 {
	TEXT-DECORATION: underline !important
}
A.gb4 {
	TEXT-DECORATION: underline !important
}
A.gb1 {
	COLOR: #00c !important
}
A.gb2 {
	COLOR: #00c !important
}
A.gb3 {
	COLOR: #00c !important
}
A.gb4 {
	COLOR: #00c !important
}
A.gb2:hover {
	BACKGROUND: #36c; COLOR: #fff !important
}
#gbar .gbz0l {
	COLOR: #000 !important; CURSOR: default; FONT-WEIGHT: bold; TEXT-DECORATION: none !important
}
BODY {
	BACKGROUND: #fff; COLOR: #222
}
INPUT {
	-moz-box-sizing: content-box
}
A {
	COLOR: #12c; TEXT-DECORATION: none
}
A:hover {
	TEXT-DECORATION: underline
}
A:active {
	TEXT-DECORATION: underline
}
.fl A {
	COLOR: #12c
}
A:visited {
	COLOR: #61c
}
A.gb1 {
	TEXT-DECORATION: underline
}
A.gb4 {
	TEXT-DECORATION: underline
}
A.gb3:hover {
	TEXT-DECORATION: none
}
#ghead A.gb2:hover {
	COLOR: #fff !important
}
.sblc {
	PADDING-TOP: 5px
}
.sblc A {
	MARGIN: 2px 0px 2px 13px; DISPLAY: block; FONT-SIZE: 11px
}
.lsbb {
	DISPLAY: inline-block; HEIGHT: 30px
}
.ftl {
	MARGIN: 0px 8px; COLOR: #12c
}
#footer A {
	MARGIN: 0px 8px; COLOR: #12c
}
#fll {
	DISPLAY: inline
}
#footer A:active {
	COLOR: #d14836
}
.lsb {
	BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; OUTLINE-WIDTH: 0px; FONT: 15px arial, sans-serif; HEIGHT: 30px; COLOR: #000; VERTICAL-ALIGN: top; BORDER-TOP: medium none; CURSOR: pointer; BORDER-RIGHT: medium none
}
.lst:focus {
	OUTLINE-STYLE: none; OUTLINE-COLOR: invert; OUTLINE-WIDTH: medium
}
#addlang A {
	PADDING-BOTTOM: 0px; PADDING-LEFT: 3px; PADDING-RIGHT: 3px; PADDING-TOP: 0px
}
.gac_v DIV {
	DISPLAY: none
}
.gac_v .gac_v2 {
	DISPLAY: block !important
}
.gac_bt {
	DISPLAY: block !important
}
#footer {
	POSITION: relative; MIN-HEIGHT: 49px; COLOR: #666; FONT-SIZE: 10pt
}
.big#footer {
	MARGIN: 0px 44px
}
.gssb_c {
	Z-INDEX: 989 !important; MARGIN-TOP: 0px !important
}
.gssb_d {
	BORDER-BOTTOM: #e7e7e7 1px solid; BORDER-RIGHT: #e7e7e7 1px solid
}
.gssb_e {
	BORDER-BOTTOM: #558be3 1px solid; BORDER-LEFT: #a2bff0 1px solid; BORDER-TOP: #a2bff0 1px solid; BORDER-RIGHT: #558be3 1px solid
}
.gssb_k {
	Z-INDEX: 988 !important
}
.gssb_i {
	BACKGROUND: #d5e2ff
}
TR.gssb_i {
	BACKGROUND: #eee; COLOR: black
}
.STYLE1 {
	top:200;
	font-family: Verdana,Tahoma,Arial,Geogia,宋体,Sans-serif;
	font-size:24px
	}
.STYLE2 {
	font-size: xx-large;
	font-weight: bold;
}
.STYLE3 {
	font-family: Verdana,Tahoma,Arial,Geogia,宋体,Sans-serif;
	font-size:12px
}
</STYLE>
<script language="JavaScript">
		function checkedChenge(obj){
			if(obj.checked){
				document.getElementById(obj.value).value=1;
			}else{
				document.getElementById(obj.value).value=0;
			}
		}
	  var historyStore;
	Ext.onReady(function(){
			 Ext.BLANK_IMAGE_URL = '/msa/extjs/resources/images/default/s.gif';
			 historyStore = new Ext.data.SimpleStore({
				      root: 'Results',
			        totalProperty: 'totalCount',
			        url:'/msa/main.xp',
			        baseParams:{Fun:'historySearch'},
				      fields: [							// text 路径 默认搜索日期 关键字	开始日期 结束日期	searchdate
				         {name: 'text'},
					       {name: 'path'},
					       {name: 'date'},
					       {name: 'keyword'},
					       {name: 'startdate'},
					       {name: 'enddate'},
					       {name: 'searchdate'},
					       {name: 'element1'},
					       {name: 'element2'},
					       {name: 'element3'},
					       {name: 'element4'},
					       {name: 'element5'},
					       {name: 'element6'}
				      ]
			 });
			 historyStore.load();
			 
			 date = new Date();
			 str  = date.getFullYear() + "/" + (date.getMonth()+1)+ "/" + date.getDate();
	     var sdate = new Ext.form.DateField({
		        id : "stime",
		        renderTo: 'sdate',
		        name : "chooseStartTime",
						format : 'Y-m-d',
		        endDateField : "etime",
		        value : new Date(Date.parse(str))
	     });
	     var edate = new Ext.form.DateField({
		        id : "etime",
	         	renderTo: 'edate',
		        name : "chooseEndTime",
						format : 'Y-m-d',
		        startDateField : "stime",
		        value : new Date(Date.parse(str))
	     });
	     var Search= Ext.get('btnG');
			 Search.on('click', function(){
						if(document.getElementById("lst-ib").value==""){
							 return false;
						}
						document.getElementById("stardate").value=Ext.getDom("stime").value;
						document.getElementById("enddate").value=Ext.getDom("etime").value;
						if(document.getElementById("stardate").value>document.getElementById("enddate").value){
							 alert("开始日期应小于结束日期")
							 //Ext.Msg.alert("提示","开始日期应小于结束日期")
							 return false;
						}
						listform.submit();
			 });
			 function flag(val){
			 		if(val==1){
			 			return('&nbsp&nbsp&nbsp&nbsp<font color="#008000">√</font>');
			 		}else return('&nbsp&nbsp&nbsp&nbsp<font color="#FF0000">×</font>');
			 }
			 xtzygrid = new Ext.grid.GridPanel({
		        store: historyStore,
		        viewConfig:{forceFit: true, scrollOffset: 1},
		        columns: [
		            {header: "关键字",   width: 100, sortable: false, dataIndex: 'keyword'},
		            {header: "开始日期",   width: 60, sortable: false, dataIndex: 'startdate'},
					      {id:'enddate',header: "结束日期", width: 60, sortable: true, dataIndex:'enddate'},
		            {header: "即时通讯",   width: 50, sortable: false, dataIndex: 'element1',renderer: flag},
		            {header: "虚拟身份",   width: 50, sortable: false, dataIndex: 'element2',renderer: flag},
		            {header: "文件",   width: 40, sortable: false, dataIndex: 'element3',renderer: flag},
		            {header: "邮件",   width: 40, sortable: false, dataIndex: 'element4',renderer: flag},
		            {header: "表单",   width: 40, sortable: false, dataIndex: 'element5',renderer: flag},
		            {header: "搜索关键字",   width: 60, sortable: false, dataIndex: 'element6',renderer: flag}
		        ],
		        stripeRows: true,
		        autoExpandColumn: 'enddate',
		        height:screen.height-210,
		        frame:true,
				    collapsible:false,
				    loadMask:{msg:'正在加载数据，请稍侯……'},
				    draggable:false
		   });
			 var rightClick  = new Ext.menu.Menu({
	                id:'feeds-ctx',
	                items: [{
	                    id:'delclient',
	                    iconCls:'load-icon',
	                    text:'删除该条记录',
	                    scope: this,
	                    handler:function(){
	                        var record = xtzygrid.getStore().getAt(detailEl);
	                        var path=record.get("path");
	                        Ext.MessageBox.confirm('Confirm', '您确认要删除该规则?', confirmdelclient);
	                        function confirmdelclient(btn){
														        if(btn=='yes'){
																				historyStore.load({params:{Fun:'historySearch',delflag:'delflag',path:path}});
														        }
												 };
	                    }
	                	},{
	                    id:'editclient',
	                    iconCls:'load-icon',
	                    text:'查看详情',
	                    scope: this,
	                    handler:function(){
	                    	var record = xtzygrid.getStore().getAt(detailEl);
	                    	var url='/msa/main.xp?Fun=msaHistoryView+path='+record.get("path")+'+filedate='+record.get("date")+'+searchdate='+record.get("searchdate")+'+keyword='+record.get("keyword")+'+stardate='+record.get("startdate")+'+enddate='+record.get("enddate")+'+element1='+record.get("element1")+'+element2='+record.get("element2")+'+element3='+record.get("element3")+'+element4='+record.get("element4")+'+element5='+record.get("element5")+'+element6='+record.get("element6");
												parent.mainviewfrm.location.href=url;
	                    }
	                	}
	     ]});
	     xtzygrid.addListener('rowcontextmenu', rightClickFn);
			  function rightClickFn(client, rowIndex, e) {
						                rightClick.showAt(e.getXY());
						                detailEl= rowIndex;
			 }
			 var configKey= Ext.get('btnI');
			 configKey.on('click', function(){
					 var historywin =new  Ext.Window({
		            title: '历史记录查询',
		           	closeAction: 'hide',
		            height: 450,
		            width: 750,
		            //modal: 'true',
		            maximizable:'false',
		            margins:'0 5 0 0',
        				items:[xtzygrid]
        	 });
					historywin.show();
			 });
	});
</script>
<body oncontextmenu="return false" topmargin=0 leftmargin=0 style="SCROLLBAR-FACE-COLOR: #f0f0f0;  overflow-x:hidden;  OVERFLOW: scroll; SCROLLBAR-SHADOW-COLOR: #f0f0f0; SCROLLBAR-3DLIGHT-COLOR: #f0f0f0; SCROLLBAR-ARROW-COLOR: #f0f0f0; SCROLLBAR-DARKSHADOW-COLOR: #cccccc;" >
<DIV id=main>
<CENTER><span><BR id=lgpd clear=all>
</span>
<DIV class="STYLE1 STYLE2" id=lga>内&nbsp;容&nbsp;关&nbsp;键&nbsp;字&nbsp;检&nbsp;索</DIV>
<form name="listform" action="/msa/main.xp" method="POST">
 <input type="hidden" name="Fun" value="msaSearchKeyWord">
 <input type="hidden" id="stardate" name="stardate" value="">
 <input type="hidden" id="enddate" name="enddate" value="">
 <input type="hidden" id="element1" name="element1" value="1">
 <input type="hidden" id="element2" name="element2" value="1">
 <input type="hidden" id="element3" name="element3" value="1">
 <input type="hidden" id="element4" name="element4" value="1">
 <input type="hidden" id="element5" name="element5" value="1">
 <input type="hidden" id="element6" name="element6" value="1">
<TABLE width="678" cellPadding=0 cellSpacing=0 class=jhp>
  <TBODY>
  <tr>
  <td width="84">&nbsp;</td>
  <td width="81" id="sdate">&nbsp;</td>
  <td width="511" id="edate">&nbsp;</td>
  </tr>
  <TR vAlign=top>
    <TD noWrap align=middle colspan="3"><DIV style="MARGIN: 4px 0px; HEIGHT: 32px" class=ds>
    	<p><span>
    		<input
      style="BORDER-BOTTOM: #d9d9d9 1px solid; BORDER-LEFT: #d9d9d9 1px solid; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-LEFT: 6px; PADDING-RIGHT: 8px; BACKGROUND: #fff; COLOR: #000; VERTICAL-ALIGN: top; BORDER-TOP: silver 1px solid; BORDER-RIGHT: #d9d9d9 1px solid; PADDING-TOP: 5px"
      id=lst-ib class=lst title="搜索" maxlength=2048 size=57 name=q autocomplete="off">
    	</span></p>
    	<p>&nbsp;</p>
    </DIV><BR style="LINE-HEIGHT: 0">
	<div class="STYLE3">
        <input type="checkbox"  value="element1" onclick='checkedChenge(this)' checked>
        即时通讯
        <input type="checkbox"  value="element2" onclick='checkedChenge(this)' checked>
        虚拟身份
        <input type="checkbox"  value="element3" onclick='checkedChenge(this)' checked>
        文件
        <input type="checkbox"  value="element4" onclick='checkedChenge(this)' checked>
        邮件
        <input type="checkbox"  value="element5" onclick='checkedChenge(this)' checked>
        表单
        <input type="checkbox"  value="element6" onclick='checkedChenge(this)' checked>
		搜索关键字
	</div>
      	<span><INPUT value="立即搜索" type=button name=btnG id="btnG" ><INPUT style="MARGIN-LEFT: 10px" value=&nbsp;历史记录管理&nbsp; type=button name=btnI id="btnI"></span></TD></TR></TBODY></TABLE>
</FORM></CENTER>
</DIV>
</body></HTML>
