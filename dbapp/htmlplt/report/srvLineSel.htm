<HTML><HEAD><TITLE>网络7层管理和过滤的领导者</TITLE>
<META content="text/html; charset=utf-8" http-equiv=Content-Type>
<LINK rel=stylesheet type=text/css href="/msa/publiccss/pubcss.css">
<LINK rel=stylesheet type=text/css href="/msa/extjs/resources/css/ext-all.css">
<link rel="stylesheet" type="text/css" href="/msa/extjs/resources/css/feed-viewer.css" />
<LINK rel=stylesheet type=text/css href="/msa/extjs/resources/css/xtheme-default.css" id="xthemecss" >
<script type="text/javascript" src="/msa/extjs/adapter/ext/ext-base.js"></script>
<script language = "Javascript" src = "/msa/publicjs/select_time.js"></script>
<SCRIPT type=text/javascript  src="/msa/extjs/ext-all.js"></SCRIPT>
<STYLE type=text/css>
HTML {
	BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: 0px; FONT: 12px verdana; HEIGHT: 100%; OVERFLOW: hidden; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px
}
BODY {
	MARGIN: 0px; BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: 0px; FONT: 12px verdana; HEIGHT: 100%; OVERFLOW: hidden; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px
}
P {
	MARGIN: 0px
}
</STYLE>
<SCRIPT type=text/javascript>
Ext.BLANK_IMAGE_URL = '/msa/extjs/resources/images/default/s.gif';
Ext.onReady(function(){	    
	var uid;
	var gid;
	var level;
	var groupmanager ="0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
groupmanager =groupmanager + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
groupmanager =groupmanager + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
groupmanager =groupmanager + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
groupmanager =groupmanager + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
groupmanager =groupmanager + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
groupmanager =groupmanager + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
groupmanager =groupmanager + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
groupmanager =groupmanager + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
groupmanager =groupmanager + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";

	var gtreepan=new Ext.tree.TreePanel({
	    	  height:400,
					split: true,
					useArrows:true,
					autoScroll: true,
					rootVisible: false,
					lines: false,
					useArrows: true,
					root:   new Ext.tree.AsyncTreeNode(),
					loader: new Ext.tree.TreeLoader({
							dataUrl:'/msa/main.xp?Fun=msaGroupTree',
							baseParams:{Fun:'msaGroupTree',type:1} 
					})

	});

    var wing;
    var button_1 = Ext.get('department');
		button_1.on('click', function(){
				if(!wing){
				var wing = new Ext.Window({
								layout      : 'fit',
                title: '选择部门',
                width       : 500,
                height      : 300,
                closeAction :'hide',
                plain       : true,
                items       : gtreepan,
								buttons: [{
                    text     : '保存选择的部门',
                    handler  : function(){
                       groupmanager ="0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
                       groupmanager =groupmanager + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
                       groupmanager =groupmanager + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
                       groupmanager =groupmanager + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
                       groupmanager =groupmanager + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
                       groupmanager =groupmanager + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
                       groupmanager =groupmanager + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
                       groupmanager =groupmanager + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
                       groupmanager =groupmanager + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
                       groupmanager =groupmanager + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
                       var selNodes = gtreepan.getChecked();
				               Ext.each(selNodes, function(node){
				                    if(node.id=='0'){
				                      groupmanager = '1' + groupmanager.substring(Number(node.id)+1);
				                    }else if(node.id=='999'){
				                      groupmanager = groupmanager.substring(0,Number(node.id)) +  '1';
				                    }else{
				                      groupmanager = groupmanager.substring(0,Number(node.id)) +  '1' + groupmanager.substring(Number(node.id)+1,1000);
				                    }
				                });
				                document.getElementById("gid").value=groupmanager;
				                wing.hide();
                    }
                },{
                    text     : '选择全部部门',
                    handler  : function(){
                        groupmanager ="1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111";
                        groupmanager =groupmanager + "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111";
                        groupmanager =groupmanager + "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111";
                        groupmanager =groupmanager + "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111";
                        groupmanager =groupmanager + "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111";
                        groupmanager =groupmanager + "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111";
                        groupmanager =groupmanager + "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111";
                        groupmanager =groupmanager + "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111";
                        groupmanager =groupmanager + "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111";
                        groupmanager =groupmanager + "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111";
                        document.getElementById("gid").value=groupmanager;
                        wing.hide();
                    }
                }] 
							   });
				}
				wing.show();

		});	


	        new Ext.Viewport({
					layout: 'border',
					items: [{
						region:'center',
						layout:'fit',
	          split:false,
	          minSize: 100,
	          maxSize: 300,
	          frame:true,
	          collapsible:true,
	          autoScroll: true,
	          margins:'0 0 0 0',
	          contentEl:'north'
	        }],
	        renderTo: Ext.getBody()
	    });

	    
	    
});
</SCRIPT>
<style>
    .complete .x-tree-node-anchor span {
        text-decoration: line-through;
        color: #777;
    }
</style>
</head>
<body>
<DIV id="north">	
<DIV id="north1">
<table width="100%" border="0" cellspacing="0" cellpadding="0" >
  <tr> 
    <td> 
        <table width="100%" border="0" cellpadding="0" cellspacing="0">
				<tr>
				    <td width="50">  &nbsp;</td>
				     <td>  &nbsp;</td>
				  </tr>
				<tr>
				     <td width="50">  &nbsp;</td>
				    <td> 第一步：选择你所需要的时间段，系统将根据时间范围生成服务协议分析流量汇总报表 </td>
				  </tr>
				</table>  
        <table width="100%" border="0" cellspacing="0" cellpadding="0" >
          <div id="plabel"> 
            <tr> 
               <td width="50" > 
                <div align="center">&nbsp;</div>
              </td>
              <td  > 
                <div align="left">
                  开始日期:
                  	<input type="text"  class=inputf0 name="sdate"  id="sdate" size="10" maxlength="10" value="" onClick=setday(sdate)>
              </div>
              </td>
             </tr> 
             
            <tr> 
             <td width="50" > 
                <div align="center">&nbsp;</div>
              </td>
              <td> 
                <div align="left">
                  结束日期:
                  <input type="text"  class=inputf0 name="edate" id="edate" size="10" maxlength="10" value="" onClick=setday(edate)>
              </div>
              </td>
             </tr> 
          <tr> 
              <td width="50" height="20"> 
                <div align="center">&nbsp;</div>
              </td>
              <td  height="20"> 
                <div align="left"> 
                 名&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;称:
                 <input type="text" class=inputf0  name="reportname" id="reportname" size="20" maxlength="32" value=""  >
                </div>
              </td>
           </tr> 

		    <tr> 
              <td width="50" height="20"> 
                <div align="center">&nbsp;</div>
              </td>
              <td  height="20"> 
                
                <div align="left"> 
                 邮件地址:
                <input type="text"  class=inputf0 name="email" id="email" size="20" maxlength="32" value=""  >  
				(填写邮件地址后生成的报告可自动发送到您的邮箱中！)
                </div>
              </td>
              </tr> 
          </div>
        </table>       
    </td>
  </tr>
</table>
</div>

<div id="north2" style="display:none">
<table width="100%" border="0" cellspacing="0" cellpadding="0" >	
	<tr>
		<td>
			<table width="100%" border="0" cellpadding="0" cellspacing="0">
				<tr>
				    <td width="50">  &nbsp;&nbsp;&nbsp;</td>
				     <td>  &nbsp;</td>
				  </tr>
				<tr>
				     <td width="50">  &nbsp;&nbsp;&nbsp;</td>
				    <td>&nbsp;&nbsp;&nbsp;&nbsp;第二步：选择你所需要的部门，系统将根据你选择的部门生成服务协议分析部门汇总报表</td>
				  </tr>
			</table>  
	    <table width="100%" border="0" cellspacing="0" cellpadding="0">
			 
	     <tr> 
		      <td width="90" height="26"> 

		        <div align="right">部门</div>

		      </td>

		      <td colspan="2" height="26">

				   <input type="button" id="department" class=inputf0 border="0" name="department" value="选择部门">

		      </td>

	     </tr>

	     <tr>

		      <td width="90" height="26">
		        <!--div align="right">用户</div-->
		      </td> 

		      <td colspan="2" height="26">

		         <div id="combobox"><div>

		      </td>             

	     </tr>

	</table>
	<td>
</tr>
</table>

</div>


<div id="north3" style="display:none">

	<p>第三步：系统将以时间为分组单位，生成服务协议分析时间汇总报表</p>

</div>

<div id="north4" style="display:none">
   <p>这是最后一步，系统将生成服务协议分析部门时间汇总报表</p>
   <input type="hidden" id="gid" value="">
   <input type="hidden" id="uid" value="">
</div>

</div>
</body>
</html>
